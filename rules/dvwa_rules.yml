groups:
  - name: dvwa-alerts
    rules:
      - alert: DVWADoSAttackSuspected
        expr: rate(probe_duration_seconds{instance="http://dvwa:80"}[1m]) > 0.1
        for: 0s
        labels:
          severity: critical
        annotations:
          summary: "â— Kháº£ nÄƒng táº¥n cÃ´ng DoS HTTP vÃ o DVWA"
          description: "Thá»i gian pháº£n há»“i DVWA tÄƒng báº¥t thÆ°á»ng trÃªn 0.1s trong 30s gáº§n nháº¥t. CÃ³ thá»ƒ Ä‘ang bá»‹ táº¥n cÃ´ng tá»« IP láº¡."

      - alert: SQLMapAttackDetected
#        expr: count_over_time({job="apache_access", __line__=~".*sqlmap.*"}[1m]) > 0
        expr: count_over_time({job="apache_access", __line__=~".*sqlmap.*"}[1m]) > 0
        for: 0s
        labels:
          severity: critical
        annotations:
          summary: "ðŸš¨ PhÃ¡t hiá»‡n SQLMap Ä‘ang táº¥n cÃ´ng!"
          description: "Log Apache chá»©a chuá»—i 'sqlmap', cho tháº¥y cÃ³ thá»ƒ Ä‘ang bá»‹ quÃ©t SQL Injection. Kiá»ƒm tra log Ä‘á»ƒ xÃ¡c Ä‘á»‹nh IP."

